<div class="app-shell">
  <div class="shell-grid">
    <aside class="sidebar">
      <div class="brand">
        <div class="logo-dot"></div>
        <div>
          <p class="eyebrow">Music</p>
          <h1>MusicApp</h1>
        </div>
      </div>
      <nav class="nav">
        <button type="button" class="nav-item active">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M3 9.5 12 3l9 6.5V21H3z" />
          </svg>
          Home
        </button>
        <button type="button" class="nav-item">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M4 5h16v2H4zm0 6h16v2H4zm0 6h10v2H4z" />
          </svg>
          Browse
        </button>
        <button type="button" class="nav-item">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M6 4h12v2H6zm-2 7h16v2H4zm4 7h8v2H8z" />
          </svg>
          Library
        </button>
      </nav>
      <div class="sidebar-section">
        <p class="eyebrow">Playlists</p>
        <div class="pill-group vertical">
          <span class="pill small">Daily Mix</span>
          <span class="pill small">Focus</span>
          <span class="pill small">Energy</span>
        </div>
      </div>
    </aside>

    <div class="content">
      <header class="top-bar">
        <div class="filters">
          <div class="search">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path
                d="M10.5 3a7.5 7.5 0 1 1 4.82 13.26l3.21 3.21-1.42 1.42-3.21-3.21A7.5 7.5 0 0 1 10.5 3Zm0 2a5.5 5.5 0 1 0 0 11 5.5 5.5 0 0 0 0-11Z" />
            </svg>
            <input type="search" placeholder="Search by title, artist, album" [value]="search()"
              (input)="updateSearch($event)" />
          </div>
          <div class="pill-group">
            @for (mood of moods; track mood) {
            <button type="button" class="pill" [class.active]="moodFilter() === mood" (click)="setMood(mood)">
              {{ mood }}
            </button>
            }
          </div>
        </div>
        <div class="user-pill">
          <div class="avatar">{{ selected()?.artist_name?.slice(0, 1) || '?' }}</div>
          <span>Now Playing</span>
        </div>
      </header>

      <main class="layout">
        <section class="now-playing panel">
          @if (selected(); as song) {
          <div class="cover">
            <div class="cover-art">{{ song.title.slice(0, 1) }}</div>
            <div>
              <p class="eyebrow">Now playing</p>
              <h2>{{ song.title }}</h2>
              <p class="meta">{{ song.artist_name }} - {{ song.album_title }}</p>
            </div>
          </div>
          <div class="controls">
            <button type="button" (click)="toggleLike(song.id)" [class.ghost]="!song.is_liked">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M12.1 8.64 12 8.77l-.1-.13C10.14 6.6 7.1 6.24 5.05 8.28c-2.06 2.04-2.06 5.36 0 7.4l6.23 6.23c.4.4 1.05.4 1.45 0l6.23-6.23c2.06-2.04 2.06-5.36 0-7.4-2.05-2.04-5.09-1.68-6.86.36Z" />
              </svg>
              {{ song.is_liked ? 'Liked' : 'Like' }}
            </button>
            <button type="button" class="primary">Play</button>
          </div>
          }
          <div class="queue">
            <p class="eyebrow">Up next</p>
            @if (queue().length === 0) {
            <p class="empty">No matches yet.</p>
            } @else {
            <ul>
              @for (song of queue(); track song.id) {
              <li>
                <div>
                  <p class="title">{{ song.title }}</p>
                  <p class="meta">{{ song.artist_name }} - {{ song.album_title }}</p>
                </div>
                <span class="length">{{ formatDuration(song.duration) }}</span>
              </li>
              }
            </ul>
            }
          </div>
        </section>

        <section class="tracks panel">
          <div class="list-head">
            <div>
              <p class="eyebrow">Library</p>
              <h3>All tracks</h3>
            </div>
            <span class="count">{{ filteredSongs().length }} tracks</span>
          </div>
          <div class="table" role="list">
            @for (song of filteredSongs(); track song.id) {
            <button type="button" class="row" role="listitem" [class.active]="selected()?.id === song.id"
              (click)="selectSong(song)">
              <div class="details">
                <p class="title">{{ song.title }}</p>
                <p class="meta">{{ song.artist_name }} - {{ song.album_title }}</p>
              </div>
              <div class="tags">
                <span class="pill small">{{ song.mood }}</span>
                <span class="length">{{ formatDuration(song.duration) }}</span>
                <button type="button" class="icon" aria-label="Like"
                  (click)="$event.stopPropagation(); toggleLike(song.id)">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path [attr.fill]="song.is_liked ? 'currentColor' : 'none'"
                      [attr.stroke]="song.is_liked ? 'currentColor' : 'currentColor'"
                      [attr.stroke-width]="song.is_liked ? 0 : 1.5"
                      d="M12.1 8.64 12 8.77l-.1-.13C10.14 6.6 7.1 6.24 5.05 8.28c-2.06 2.04-2.06 5.36 0 7.4l6.23 6.23c.4.4 1.05.4 1.45 0l6.23-6.23c2.06-2.04 2.06-5.36 0-7.4-2.05-2.04-5.09-1.68-6.86.36Z" />
                  </svg>
                </button>
              </div>
            </button>
            }
          </div>
        </section>
      </main>
    </div>
  </div>

  <footer class="player-bar">
    @if (selected(); as song) {
    <div class="player-meta">
      <div class="mini-cover">{{ song.title.slice(0, 1) }}</div>
      <div>
        <p class="title">{{ song.title }}</p>
        <p class="meta">{{ song.artist_name }}</p>
      </div>
    </div>
    <div class="player-controls">
      <button type="button" aria-label="Previous">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="m14 6-8 6 8 6V6zm2 0h2v12h-2V6z" />
        </svg>
      </button>
      <button type="button" class="play" aria-label="Play">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M8 5v14l11-7z" />
        </svg>
      </button>
      <button type="button" aria-label="Next">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="m10 6 8 6-8 6V6zm-2 0H6v12h2V6z" />
        </svg>
      </button>
    </div>
    <div class="player-extra">
      <button type="button" (click)="toggleLike(song.id)" aria-label="Toggle like">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path [attr.fill]="song.is_liked ? 'currentColor' : 'none'"
            [attr.stroke]="song.is_liked ? 'currentColor' : 'currentColor'"
            [attr.stroke-width]="song.is_liked ? 0 : 1.5"
            d="M12.1 8.64 12 8.77l-.1-.13C10.14 6.6 7.1 6.24 5.05 8.28c-2.06 2.04-2.06 5.36 0 7.4l6.23 6.23c.4.4 1.05.4 1.45 0l6.23-6.23c2.06-2.04 2.06-5.36 0-7.4-2.05-2.04-5.09-1.68-6.86.36Z" />
        </svg>
      </button>
    </div>
    }
  </footer>
</div>